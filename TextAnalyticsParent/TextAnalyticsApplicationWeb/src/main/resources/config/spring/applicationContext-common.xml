<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:cache="http://www.springframework.org/schema/cache"
       xmlns:p="http://www.springframework.org/schema/p"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
	http://www.springframework.org/schema/beans/spring-beans.xsd
	http://www.springframework.org/schema/cache
	http://www.springframework.org/schema/cache/spring-cache.xsd
	http://www.springframework.org/schema/context
	http://www.springframework.org/schema/context/spring-context.xsd"
       default-lazy-init="true">

    <!-- *******************************
         ***** CACHE CONFIGURATION *****
         ******************************* -->

    <!-- Enables caching through annotations -->
    <cache:annotation-driven key-generator="enhancedDefaultKeyGenerator"/>
    <bean id="enhancedDefaultKeyGenerator" class="org.springframework.cache.interceptor.DefaultKeyGenerator"/>

    <bean id="cacheManager" class="org.springframework.cache.ehcache.EhCacheCacheManager" p:cache-manager-ref="ehcache" scope="singleton">
        <property name="cacheManager" ref="ehcache"/>
    </bean>

    <!-- EhCache library setup -->
    <bean id="ehcache" class="org.springframework.cache.ehcache.EhCacheManagerFactoryBean" scope="singleton" p:config-location="classpath:config/cache/ehcache.xml"/>

    <!-- Application configuration - install by MSI -->
    <bean id="textAnalyticsWebAppApplicationPropertiesConfigFile" class="com.verint.textanalytics.common.configuration.ConfigurationFile" scope="singleton" lazy-init="true">
        <constructor-arg name="path" value="/config/production/application.properties"/>
        <constructor-arg name="pathType" value="ClassPath"/>
        <constructor-arg name="configurationSource" value="PropertiesConfiguration"/>
        <constructor-arg name="isMandatory" value="true"/>
    </bean>

    <!-- Environment configuration - Created by Plug-in -->
    <bean id="textAnalyticsWebAppEnvironmentPropertiesConfigFile" class="com.verint.textanalytics.common.configuration.ConfigurationFile" scope="singleton" lazy-init="true">
        <constructor-arg name="path" value="/TextAnalyticsWebApp/Config/environment.properties"/>
        <constructor-arg name="pathType" value="DataDirRelativePath"/>
        <constructor-arg name="configurationSource" value="PropertiesConfiguration"/>
        <constructor-arg name="isMandatory" value="true"/>
    </bean>

    <!-- Local configuration - Manually created - Optional -->
    <bean id="textAnalyticsWebAppLocalPropertiesConfigFile" class="com.verint.textanalytics.common.configuration.ConfigurationFile" scope="singleton" lazy-init="true">
        <constructor-arg name="path" value="/TextAnalyticsWebApp/Config/local.properties"/>
        <constructor-arg name="pathType" value="DataDirRelativePath"/>
        <constructor-arg name="configurationSource" value="PropertiesConfiguration"/>
        <constructor-arg name="isMandatory" value="false"/>
    </bean>

    <bean id="configurationManager" class="com.verint.textanalytics.common.configuration.ConfigurationManager" scope="singleton" lazy-init="true">
        <constructor-arg ref="textAnalyticsWebAppApplicationPropertiesConfigFile"/>
        <constructor-arg ref="textAnalyticsWebAppEnvironmentPropertiesConfigFile"/>
        <constructor-arg ref="textAnalyticsWebAppLocalPropertiesConfigFile"/>
    </bean>

    <!-- JWTService  -->
    <bean id="JWTTokenService" class="com.verint.authorization.services.JWTTokenService" scope="singleton" lazy-init="true"></bean>
    <bean id="JWTService" class="com.verint.textanalytics.common.security.JWTService" init-method="initIt" scope="singleton" lazy-init="true"></bean>

    <bean id="modelEditorSecretFile" class="com.verint.textanalytics.common.security.ModelEditorSecretFile" scope="singleton" lazy-init="true">
        <constructor-arg name="path" value="/conf/Security/hashmap.ser"/>
        <constructor-arg name="pathType" value="SoftwareDirRelativePath"/>
    </bean>

    <bean class="com.verint.textanalytics.common.diagnostics.PerformanceMetrics" lazy-init="true" scope="singleton">
        <constructor-arg name="configurationManager" ref="configurationManager"></constructor-arg>
    </bean>

    <!-- AWTService  -->
    <bean class="com.verint.textanalytics.common.security.AWTService" scope="singleton" lazy-init="true" init-method="initialize" />

</beans>